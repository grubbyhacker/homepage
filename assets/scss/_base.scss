/* ===============================
   Base / Layout / Typography
   =============================== */

/* Root safety (keep content inside the viewport) */
html,
body {
  max-width: 100%;
  overflow-x: hidden; // remove later if you want; safe to keep
}

/* Typography */
body {
  font-family: 'Merriweather Sans', sans-serif;
  font-size: 1.25em;
  font-weight: 300;
  color: var(--text);
  background-color: var(--bg);
}

body.loading {
  visibility: hidden;
}

/* Headings (HTML is case-insensitive but use lowercase for consistency) */
h1 { font-size: 2em; }
h2 { font-size: 1.5em; }

/* Links */
a {
  color: var(--link);
  text-decoration: underline;

  &:visited { color: var(--link-visited); }
  &:hover,
  &:focus-visible { color: var(--link-hover); }
}

/* Form bits */
select {
  padding: 8px;
  border: 1px solid var(--bg);
  border-radius: 2em;
  color: var(--text);
  background-color: var(--bg-alt);
  margin-right: 1em;
}

/* Utilities */
.sitelink {
  border: 2px solid transparent;
  border-radius: 8px;
  text-decoration: none;
  padding: 0;
  color: var(--sitelink);

  &:visited { color: var(--sitelink); }
  &:hover   { border: 2px solid var(--border-strong); }
}

.invisible { visibility: hidden; }
.centered-element { margin: auto; }

blockquote {
  position: relative;
  font-size: 1rem;
}

/* Media defaults */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* ===============================
   Content Container
   =============================== */

:root {
  --content-max: 72ch;                 // comfy reading width
  --side-pad: clamp(12px, 4vw, 20px);  // nice mobile gutters
}

.content {
  // Avoid Sass min()/var() conflict by using width+max-width instead of min()
  width: 100%;
  max-width: var(--content-max);
  margin-inline: auto;
  padding-inline: var(--side-pad);
  box-sizing: border-box;
  line-height: 1.55;

  /* Headings wrap nicely on phones */
  h1, h2, h3 {
    overflow-wrap: anywhere;
    word-break: normal;
    hyphens: auto;
    line-height: 1.2;
  }

  /* Media stay inside column */
  img,
  video,
  iframe,
  svg,
  canvas {
    max-width: 100%;
    height: auto;
  }

  /* Markdown tables & Chroma lntable scroll instead of stretching */
  table {
    display: block;
    width: 100%;
    max-width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  table.lntable {
    // Chroma’s line-number table
    display: block;
    width: 100%;
    max-width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;

    td { white-space: pre; } // keep code formatting
  }

  /* ===============================
     Code (block + inline)
     =============================== */

  // Block code (pre owns the box)
  pre,
  pre.chroma,
  .highlight pre {
    background-color: var(--pre-bg);
    border: 1px solid var(--pre-border);
    border-radius: 6px;
    padding: 0.75rem 1rem;

    // Critical: clamp to column and keep long lines local
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
    overflow-x: auto;       // horizontal scroll inside the block
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    white-space: pre;       // preserve formatting; no wrap by default
  }

  // Outer wrappers shouldn’t exceed the column
  .highlight,
  .chroma {
    max-width: 100%;
    overflow: hidden;       // inner pre will scroll
  }

  // Inline code style
  code {
    font-family: monospace;
    font-size: 0.9em;
    background-color: var(--code-bg);
    padding: 0.2em 0.4em;
    border-radius: 3px;
  }

  // Neutralize inline code styling inside block code
  pre code {
    display: block;
    background: transparent;
    padding: 0;
    border-radius: 0;
    box-shadow: none;
    white-space: inherit;   // inherit from pre
  }

  // Inline code inside text can wrap long tokens (URLs, hashes, etc.)
  p code,
  li code,
  blockquote code,
  dd code,
  td code {
    white-space: normal;
    overflow-wrap: anywhere; // modern
    word-break: break-word;  // fallback
  }

  /* Optional: on small screens, wrap long code lines instead of scroll */
  @media (max-width: 600px) {
    pre,
    pre.chroma,
    .highlight pre {
      white-space: pre-wrap;
      overflow-wrap: anywhere;
      word-break: normal;
    }
  }
}

/* Wider layout for Section/Home pages on desktop */
@media (min-width: 1024px) {
  .is-section .content,
  .is-home .content {
    --content-max: 1200px;   // or 100ch, or 70rem, your call
  }
}

/* Even wider on very large displays (optional) */
@media (min-width: 1440px) {
  .is-section .content,
  .is-home .content {
    --content-max: 1400px;
  }
}
